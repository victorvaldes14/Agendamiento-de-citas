{% extends 'master.html' %}
{% block title %}Agendar Cita{% endblock %}
{% block content %}
<h1>Agendar tu Cita</h1>
<form method="post">
  {% csrf_token %}
  {{ form.as_p }}
  <button type="submit" class="btn-submit">Confirmar Cita</button>
</form>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const fechaInput = document.querySelector('input[type="date"]');
  const horaSelect = document.querySelector('select[name="hora"]');
  fechaInput.addEventListener('change', () => {
    fetch(`/horas/?fecha=${fechaInput.value}`)
      .then(r => r.json())
      .then(data => {
        horaSelect.innerHTML = '';
        data.horas.forEach(h => {
          const opt = document.createElement('option');
          opt.value = h;
          opt.textContent = h;
          horaSelect.appendChild(opt);
        });
      });
  });
});
</script>
{% endblock %}
